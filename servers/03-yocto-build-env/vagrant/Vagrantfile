# Vagrantfile for setting up a Yocto build environment

Vagrant.configure("2") do |config|
  # Base box
  config.vm.box = "ubuntu/jammy64"

  # VM settings
  config.vm.provider "virtualbox" do |vb|
    vb.memory = "8192"
    vb.cpus = 4
  end

  # Networking
  config.vm.network "private_network", ip: "192.168.33.12"

  # Sync folder between host and guest (optional)
  # config.vm.synced_folder "./yocto-project", "/home/vagrant/yocto-project"

  # Provisioning script
  config.vm.provision "shell", inline: <<-SHELL
    # Update the package list
    sudo apt-get update

    # Install required packages for Yocto
    sudo apt-get install -y \
      gawk wget git-core diffstat unzip texinfo gcc-multilib \
      build-essential chrpath socat cpio python3 python3-pip \
      python3-pexpect xz-utils debianutils iputils-ping \
      libsdl1.2-dev xterm

    # Install optional packages for additional build tools
    sudo apt-get install -y \
      python3-git python3-jinja2 libegl1-mesa libsdl1.2-dev \
      pylint3 xz-utils debianutils iputils-ping

    # Clean up
    sudo apt-get clean
  SHELL

  # SSH access
  config.ssh.insert_key = false

  # Set up a custom hostname (optional)
  config.vm.hostname = "yocto-build-machine"

  # Optional: Sync time between host and guest
  config.vm.provision "shell", inline: <<-SHELL
    sudo apt-get install -y ntp
    sudo service ntp start
  SHELL
end
